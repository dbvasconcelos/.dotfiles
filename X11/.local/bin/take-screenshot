#!/usr/bin/env bash

# Lets you choose the kind of screenshot to take, including copying the image or even
# highlighting an area to copy.

picsdir=$(xdg-user-dir PICTURES)

# Runs maim and saves the image on a file
maim2file() {
	picname="$picsdir/screenshot-$(date '+%Y-%m-%d-%H%M').png"
    maim "$@" "$picname" && notify-send "Screenshot created" "$picname" && exit
}

# Runs maim and saves the image on the clipboard
maim2clipboard() {
    maim "$@" | xclip -selection clipboard -t image/png && notify-send "Screenshot copied to clipboard" && exit
}

options="\
( > ) selected area: maim2file -s
( > ) current window: maim2file -i $(xdotool getactivewindow)
( > ) full screen: maim2file
( > ) selected area: maim2clipboard -s
( > ) current window: maim2clipboard -i $(xdotool getactivewindow)
( > ) full screen: maim2clipboard
"

# choicestxt=printf "%s\n" "${options[@]}"

choice="$(echo "$options" | cut -d: -f1 | dmenu -l 6 -i -r -p "Screenshot: ")" || exit 1

# Run the chosen command
eval "$(printf "%s\n" "${options[@]}" | grep "^$choice:" | cut -d: -f2)"
